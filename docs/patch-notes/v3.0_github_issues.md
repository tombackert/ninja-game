# GitHub Issues Seed (v3.0 Polish & Core Experience)

All issues must satisfy Definition of Done and include automated tests + manual smoke validation before merge.

---
## Priority A: Critical Bugs & Game Feel

### Issue 47: Fix Pause State logic leak
### Context
Currently, the camera continues to scroll and some game logic persists even when the game is paused. This breaks the "pause" illusion and can lead to unfair deaths or state drift.
### Tasks
- [x] Move camera scroll logic from `Renderer.render` to `GameState.update`
- [x] Ensure `PauseState` effectively halts all `GameState` updates
### Changes
- `renderer.py`
- `game.py` (GameState update loop)
### Acceptance Criteria
- [x] Camera freezes instantly upon pausing
- [x] No entities move or update while paused
### Risks
Camera jitter if update/render decoupling is not smooth.
### Test Cases
1. Move character -> Pause -> Wait 5s -> Resume -> Position/Camera identical
### Definition of Done
- [x] Manual test confirming freeze
- [x] Code review of update loop

### Issue 48: Fix Respawn Determinism ("Sky Fall Bug")
### Context
Player respawn coordinates vary, and RNG state might not be resetting correctly, causing replays to desync after a death/respawn cycle.
### Tasks
- [ ] Enforce strict coordinate resets in `Player.respawn`
- [ ] Ensure `RNGService` is reset or rolled back correctly upon respawn/level restart
### Changes
- `entities.py` (Player class)
- `game.py` (Respawn logic)
### Acceptance Criteria
- [ ] Replaying a run with a death produces identical results to the live run
- [ ] Player always spawns at the exact `spawn_point` coordinates
### Risks
Breaking existing level entry animations.
### Test Cases
1. Record run with death -> Replay -> Verify no divergence
### Definition of Done
- [ ] Automated replay test with forced death

### Issue 49: Smoother Level Transitions
### Context
Current level switching is abrupt. We need a "Level Complete" flow to improve pacing.
### Tasks
- [ ] Implement `LevelCompleteState` (or overlay)
- [ ] Add "Finish Screen" -> "Confirmation" -> "Next Level" flow
### Changes
- `state_manager.py`
- `game.py`
- New `level_complete.py` (optional, or part of menus)
### Acceptance Criteria
- [ ] Touching flag triggers summary screen instead of instant switch
- [ ] Player can proceed or replay level
### Risks
State transition bugs (double inputs).
### Test Cases
1. Finish level -> Verify Summary UI appears -> Click Next -> Load Next
### Definition of Done
- [ ] Manual UI flow check

### Issue 50: Fix Performance HUD conflicts
### Context
The Performance HUD has conflicting controls (Menu vs F1) and displays incorrect parameters (e.g., cache stats).
### Tasks
- [ ] Remove "Show HUD" option from main menu
- [ ] Centralize visibility logic to `F1` key toggle only
- [ ] Fix data binding for cache/memory metrics
### Changes
- `perf_hud.py`
- `menu.py`
- `settings.py`
### Acceptance Criteria
- [ ] F1 reliably toggles HUD in all states
- [ ] Metrics are accurate (non-zero/non-static where expected)
### Risks
None.
### Test Cases
1. Toggle F1 -> HUD appears -> Toggle F1 -> HUD hides
### Definition of Done
- [ ] Manual verification

### Issue 51: Ghost Polish (Idle at Finish)
### Context
Ghosts disappear immediately upon reaching the finish line, which looks jarring.
### Tasks
- [ ] Modify `GhostPlayer` to switch to an "idle" or "celebrate" animation state upon finishing
- [ ] Persist ghost entity until the live player finishes or restarts
### Changes
- `replay.py` (Ghost logic)
### Acceptance Criteria
- [ ] Ghost remains visible at the flag after finishing its run
### Risks
Ghost overlapping with live player visibility.
### Test Cases
1. Watch replay -> Ghost finishes -> Ghost stays on screen
### Definition of Done
- [ ] Manual visual check

---
## Priority B: Content & Extensibility

### Issue 52: New AI Behaviors (Chaser & Jumper)
### Context
Validate `PolicyService` extensibility by adding more complex enemy types.
### Tasks
- [ ] Implement `Chaser` policy: actively pathfinds/moves towards player within range
- [ ] Implement `Jumper` policy: moves vertically to block paths
- [ ] Register new policies in `PolicyService`
### Changes
- `scripts/ai/` (new policy files)
### Acceptance Criteria
- [ ] Enemies with these policies behave distinctively from "Patrol"
- [ ] Configurable parameters (speed, range) working
### Risks
Pathfinding performance cost.
### Test Cases
1. Spawn Chaser -> Move Player -> Chaser follows
### Definition of Done
- [ ] Unit test for decision logic

### Issue 53: Upgrade Audio Experience (Level Soundtracks)
### Context
Each level currently lacks a distinct auditory identity.
### Tasks
- [ ] Update `AssetManager`/`AudioService` to support per-level music tracks
- [ ] Assign unique tracks to existing levels (using placeholders if needed)
- [ ] Standardize entity SFX (volume, mixing)
### Changes
- `audio_service.py`
- `data/maps/*.json` (config additions)
### Acceptance Criteria
- [ ] Different levels play different background music
### Risks
Increased asset size (lazy load music!).
### Test Cases
1. Load Level 1 -> Track A plays; Load Level 2 -> Track B plays
### Definition of Done
- [ ] Manual audio check

### Issue 54: Audio Ducking
### Context
Game events (explosions, death) should temporarily lower background music volume.
### Tasks
- [ ] Implement ducking logic in `AudioService`
- [ ] Trigger ducking on specific event bus signals
### Changes
- `audio_service.py`
- `game.py` (trigger points)
### Acceptance Criteria
- [ ] Music volume dips and recovers smoothly during loud SFX
### Risks
Audio popping/glitches.
### Test Cases
1. Trigger explosion -> Check music channel volume < 1.0
### Definition of Done
- [ ] Unit test with mock mixer

### Issue 55: Configurable Key Bindings (Backend)
### Context
Hardcoded keys are inaccessible. We need a backend system to remap them, even if the UI isn't ready.
### Tasks
- [ ] Refactor `InputRouter` to look up keys from a mapping dict
- [ ] Load mapping from `settings.json`
### Changes
- `input_router.py`
- `settings.py`
### Acceptance Criteria
- [ ] Changing `settings.json` alters control scheme
### Risks
Input conflicts (two actions same key).
### Test Cases
1. Map Jump to 'Z' -> 'Z' triggers jump, Space does not
### Definition of Done
- [ ] Unit test

---
## Priority C: Infrastructure

### Issue 56: Localization Foundation (i18n)
### Context
Prepare the codebase for multiple languages by removing hardcoded strings.
### Tasks
- [ ] Create `data/strings.json` (en-US)
- [ ] Create `LocalizationService` or helper
- [ ] Replace hardcoded UI strings with key lookups
### Changes
- `ui.py`
- `menu.py`
- New `localization.py`
### Acceptance Criteria
- [ ] Changing locale in config loads different strings (mock test)
- [ ] No raw English strings in UI rendering code
### Risks
UI layout breakage with longer strings.
### Test Cases
1. Switch to "Pseudo-loc" -> UI displays modified strings
### Definition of Done
- [ ] Code review of UI files
